<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Archivio Tornei</title>
    <link rel="stylesheet" th:href="@{/generale.css}">

    <style>
        .section-title {
            color: #00bf63;
            font-size: 1.8rem;
            margin-bottom: 25px;
            border-bottom: 3px solid #00bf63;
            padding-bottom: 8px;
        }

        .icon-ranking {
            width: 60px;
            height: 60px;
            vertical-align: middle;
            margin-right: 5px;
            object-fit: contain;
        }

        .medaglia-4 {
            font-size: 65%;
        }

    </style>

</head>
<body>

<header>
    <div class="header-content">
        <img src="/images/logo_homepage_negativo-trasparente.png" alt="Logo" class="header-logo-small">
        <div class="header-text">
            <h1>Archivio Tornei</h1>
        </div>
    </div>
</header>

<nav>
    <a th:href="@{/homepage}">Home</a>
    <a th:href="@{/tabellone}">Nuovo Torneo</a>
    <a th:href="@{/regolamento}">Regolamento</a>
    <a th:href="@{/squadre-disponibili}">Team disponibili</a>
    <div class="nav-dropdown">
        <span class="nav-dropdown-title">Registrazione</span>
        <div class="nav-dropdown-menu">
            <a th:href="@{/registra-squadre}">Squadre</a>
            <a th:href="@{/registra-giocatori}">Giocatori</a>
        </div>
    </div>
    <a th:href="@{/contatti}">Chi siamo</a>
    <a th:href="@{/loginadmin}">Area Admin</a>
</nav>


<!-- MESSAGGIO NESSUN TORNEO -->
<div th:if="${!esistonoTornei}" class="no-tornei-container">
    <h2> <img th:src="@{/images/rigore_fail.png}" class="icon-ranking" alt="Fail"> Nessun torneo in archivio </h2>
    <p>Non √® ancora stata completata alcuna competizione.</p>
    <p>Simula un torneo per iniziare a creare lo storico!</p>

    <div class="button-row" style="margin-bottom: 50px">
        <button onclick="tornaIndietro()">Indietro</button>
    </div>

</div>


<div th:if="${esistonoTornei}" class="container archivio-tornei">

    <!-- ALBO D'ORO -->
    <section class="archivio-section">
        <h2 class="section-title">
            <img th:src="@{/images/albo_oro.png}" class="icon-ranking" alt="AlboD'Oro">
            Albo d‚ÄôOro
        </h2>

        <div class="albo-grid">
            <a th:each="record : ${alboDOro}"
               th:href="@{/dettagliotorneo/{id}(id=${record['idTorneo']})}"
               class="albo-card-link">

                <div class="albo-card">

                    <h3 th:text="${record['torneo']}">Torneo</h3>

                    <div class="vincitore-box">
                        <img th:src="${record['vincitoreLogo']}"
                             alt="Logo Vincitore"
                             onerror="this.src='/images/default_logo.png'">
                        <p th:text="${record['vincitore']}">Squadra Vincitrice</p>
                    </div>

                    <div class="medaglia-trophy">üèÜ</div>
                </div>
            </a>
        </div>
    </section>



    <!-- RANKING SQUADRE -->
    <section class="archivio-section">
        <h2 class="section-title"> <img th:src="@{/images/ranking.png}" class="icon-ranking" alt="Ranking"> Ranking Storico Squadre</h2>
        <table class="ranking-table">
            <thead>
            <tr>
                <th>#</th>
                <th>Squadra</th>
                <th>Partecipazioni</th>
                <th>Tornei vinti (üèÜ)</th>
                <th>Podi (ü•á/ü•à/ü•â)</th>
                <th>Quarti posti (<span class="medaglia-4">4</span>)</th>
            </tr>
            </thead>
            <tbody id="ranking-squadre">
            <tr th:each="squadra, stat : ${rankingSquadre}">
                <td th:text="${stat.index + 1}">1</td>
                <td th:text="${squadra['squadra']}">Squadra</td>
                <td th:text="${squadra['partecipazioni'] ?: 0}">0</td>
                <td th:text="${squadra['ori']}">0</td>
                <td>
                    <span th:text="${squadra['ori']}">0</span> /
                    <span th:text="${squadra['argenti']}">0</span> /
                    <span th:text="${squadra['bronzi']}">0</span>
                </td>
                <td th:text="${squadra['quarti']}">0</td>
            </tr>
            </tbody>
        </table>
    </section>

    <!-- RECORD INDIVIDUALI -->
    <section class="archivio-section">
        <h2 class="section-title"> <img th:src="@{/images/hall_of_fame.png}" class="icon-ranking" alt="Ranking"> Hall of Fame</h2>
        <div class="record-grid">
            <div th:each="entry : ${hallOfFame}" class="record-card">
                <div class="record-icon-box">
                    <img th:if="${entry.key == 'Pi√π Partite Vinte'}" th:src="@{/images/piu_vittorie.png}" class="icon-ranking">
                    <img th:if="${entry.key == 'Miglior Attacco'}" th:src="@{/images/best_attacco.png}" class="icon-ranking">
                    <img th:if="${entry.key == 'Muro Difensivo'}" th:src="@{/images/muro_difesa.png}" class="icon-ranking">
                    <img th:if="${entry.key == 'Pichichi Storico'}" th:src="@{/images/pichichi.png}" class="icon-ranking">
                    <img th:if="${entry.key == 'Para rigori'}" th:src="@{/images/best_portiere.png}" class="icon-ranking">
                    <img th:if="${entry.key == 'Partita Spettacolo'}" th:src="@{/images/partita_show.png}" class="icon-ranking">
                </div>
                <div class="record-info">
                    <h4 th:text="${entry.key}">Titolo Record</h4>
                    <p th:text="${entry.value}">Nome Squadra/Giocatore (Valore)</p>
                </div>
            </div>
        </div>
    </section>


    <!-- CLASSIFICA MARCATORI ALL TIME -->
    <section class="archivio-section">
        <h2 class="section-title">
            <img th:src="@{/images/marcatore_all_time.png}" class="icon-ranking" alt="Marcatori all time">
            Marcatori All Time
        </h2>

        <table class="ranking-table">
            <thead>
            <tr>
                <th>#</th>
                <th>Giocatore</th>
                <th>Squadra</th>
                <th>Tipologia</th>
                <th>Partite Giocate</th>
                <th>Gol Totali</th>
                <th>Rigori in Partita</th>
                <th>Media Gol</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="giocatore, stat : ${classificaMarcatori}">
                <td th:text="${giocatore['posizione'] != 0 ? giocatore['posizione'] : '='}">1</td>
                <td th:text="${giocatore['nomeCompleto']}">Nome Cognome</td>
                <td th:text="${giocatore['squadra']}">Squadra</td>
                <td th:text="${giocatore['tipologia']}">Tipologia</td>
                <td th:text="${giocatore['partecipazioni']}">Partite Giocate</td>
                <td th:text="${giocatore['gol']}">Gol totali</td>
                <td th:text="${giocatore['rigori']}">Rigori segnati</td>
                <td th:text="${giocatore['mediaGol']}">Media gol/partite</td>
            </tr>
            </tbody>
        </table>

    </section>


    <!-- CLASSIFICA PORTIERI ALL TIME -->
    <section class="archivio-section">
        <h2 class="section-title">
            <img th:src="@{/images/guanto_oro.png}" class="icon-ranking" alt="Portieri all time">
            Migliori Portieri All Time
        </h2>

        <table class="ranking-table">
            <thead>
            <tr>
                <th>#</th>
                <th>Portiere</th>
                <th>Squadra</th>
                <th>Partite Giocate</th>
                <th>Rigori Totali Parati</th>
                <th>Clean Sheets Totali</th>
                <th>Partite decise ai rigori</th>
                <th>Rigori Lotteria Totali Parati</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="portiere, stat : ${classificaPortieri}">
                <td th:text="${portiere['posizione'] != 0 ? portiere['posizione'] : '='}">1</td>
                <td th:text="${portiere['nomeCompleto']}">Nome Cognome</td>
                <td th:text="${portiere['squadra']}">Squadra</td>
                <td th:text="${portiere['partiteGiocate']}">Partite Giocate</td>
                <td th:text="${portiere['rigoriParati']}">Rigori Parati in partita</td>
                <td th:text="${portiere['cleanSheets']}">Clean Sheets</td>
                <td th:text="${portiere['partiteDeciseRigori']}">Partite Lotteria Rigori</td>
                <td th:text="${portiere['rigoriLotteriaParati']}">Rigori Parati in lotteria</td>
            </tr>
            </tbody>
        </table>

    </section>

    <div class="button-row" style="margin-bottom: 50px">
        <button onclick="tornaIndietro()">Indietro</button>
    </div>

</div>

<footer>
    <p>&copy; 2024 Sprint Football Simulation - Generation Sport</p>
</footer>

<script>
    function tornaIndietro() {
        // Controlla se esiste una pagina di provenienza nel browser
        if (document.referrer && document.referrer !== "" && !document.referrer.includes('/loginadmin')) {
            // Torna alla pagina esatta da cui l'utente √® arrivato
            window.location.href = document.referrer;
        } else {
            // Se non c'√® una provenienza (es. accesso diretto all'URL), vai alla Home
            window.location.href = '/';
        }
    }
</script>

</body>
</html>
